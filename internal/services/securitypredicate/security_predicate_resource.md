---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "azuresql_security_predicate Resource - terraform-provider-azuresql"
subcategory: ""
description: |-
  Manage a database security predicate.
---

# azuresql_security_predicate (Resource)

 Manage a database security predicate.


**Supported**: `SQL database` 

**Not supported**: `Synapse dedicated database`, `Synapse serverless database`


## Example Usage

```terraform
provider "azuresql" {
}

data "azuresql_sqlserver" "server" {
  server = "mysqlserver"
}

data "azuresql_database" "database" {
  server = data.azuresql_sqlserver.server.id
  name   = "mydatabase"
}

data "azuresql_schema" "dbo" {
    database  = data.azuresql_database.database.id
    name      = "dbo"
}

resource "azuresql_function" "filter" {
    database  = data.azuresql_database.database.id
    name      = "filter"
    schema    = data.azuresql_schema.dbo.id
    raw       = <<-EOT
        create function dbo.filter(@user as varchar(50))
        returns table 
        with SCHEMABINDING AS
        return  select 1 as result
        where @user in (select suser_sname())
    EOT
}

resource "azuresql_security_policy" "filter" {
  database = data.azuresql_database.database.id
  name     = "filter_policy"
  schema   = data.azuresql_schema.dbo.id
}

data "azuresql_table" "mytable" {
    database  = data.azuresql_database.database.id
    schema    =  data.azuresql_schema.dbo.id
    name      = "mytable"
}

resource "azuresql_security_predicate" "filter_select" {
  database          = data.azuresql_database.database.id
  security_policy   = azuresql_security_policy.filter.id
  table             = data.azuresql_table.mytable.id
  rule              = "dbo.filter(user)"
  type              = "filter"

  # a lifecyle rule informs Terraform about the dependency between this predicate and the function
  lifecycle {
    replace_triggered_by = [azuresql_function.filter]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Argument reference
The following arguments are supported:

- `database` (Required, String) ID of the database where the security policy should be created.
- `rule` (Required, String) Expression used to check access.
- `security_policy` (Required, String) ID of the `azuresql_security_policy` resource to which this predicate belongs.
- `table` (Required, String) ID of the `azuresql_table` to which this predicate applies.
- `type` (Required, String) Type of the security predicate. Allowed values: `"filter"`, `"block"`.

- `block_restriction` (Optional, String) Type of operation specified for the block predicate. Allowed values: `""` (all applicable operations - default), `"after insert`, `"after update"`, `"before update"`, `"before delete"`

### Attributes Reference
In addition to the arguments listed above, the following read only attributes are exported:

- `id` (String) azuresql ID of the security predicate resource.
- `predicate_id` (Number) ID of the security predicate in the database.

## ID structure

The ID is formed as `<database>`/securitypredicate/`<policy id>/<predicate id>`, where
* `<database>` is the ID of the `azuresql_database` resource.
* `<policy id>` is the id of the security policy in the database. It can be found by running `select object_id('<schema name>.<security policy name>')`.
* `<predicate id>` is the ID of the predicate in the database. You can find the predicate id from `select * from sys.security_predicates`

## Import

You can import a security predicate using 

```shell
terraform import azuresql_security_predicate.<resource name> <id>
```